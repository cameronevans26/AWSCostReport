# AWS Cost Report Generator

This project uses Python and Ansible to generate a monthly AWS cost report by querying the AWS Cost Explorer API. It formats the results and emails the report to a specified list of recipients.

---

## Intended Use

This project is designed for **company/enterprise environments** and is intended to run on Ansible Tower (AWX) or Ansible Automation Platform for automated AWS cost reporting. It can also be run manually using Ansible and Python on a local machine.

## Features

✅ Fetches monthly AWS costs broken down by service  
✅ Sorts and formats costs in a readable report  
✅ Sends the report via email using SMTP  
✅ Supports multiple AWS accounts  
✅ Uses environment variables for credentials (secure!)  
✅ Integrates with Ansible for automated runs

---

## Prerequisites

- **Python 3.6+**
- **Ansible 2.9+** (or any recent version that supports `ansible.builtin.command`)
- **AWS Cost Explorer enabled** in your AWS account(s)
- **IAM permissions** to call `ce:GetCostAndUsage` for the account(s)
- SMTP server information (configured in the script)
- Ansible Vault (optional but recommended) to securely store AWS credentials (called for in AWSCostReport.yml but can be removed)

---

## Installation

1. Clone the repository:
   ```bash
   git clone https://github.com/yourusername/AWSCostReport.git
   cd AWSCostReport
2. Install Python dependencies:
  ```bash
  pip install boto3
  ```

## Configuration

This project uses environment variables to provide AWS credentials securely:

| Variable                  | Description                  |
|---------------------------|------------------------------|
| AWS_ACCESS_KEY_ID_DEV     | Access key for account 1     |
| AWS_SECRET_ACCESS_KEY_DEV | Secret key for account 1     |
| AWS_ACCESS_KEY_ID_DEV2    | Access key for account 2     |
| AWS_SECRET_ACCESS_KEY_DEV2| Secret key for account 2     |
| AWS_ACCESS_KEY_ID_DEV3    | Access key for account 3     |
| AWS_SECRET_ACCESS_KEY_DEV3| Secret key for account 3     |

> **Tip:** You can export them in your shell or use Ansible Vault (recommended for production).

## Run it:
  bash
  `ansible-playbook -i localhost, AWSCostReport.yml`

## Example Output

Below is a snippet of the report generated by the script:

```
AWS Cost Report for May 2025 (2025-05-01 to 2025-05-31)
Account: it-dev
==================================================
Amazon Elastic Container Service for Kubernetes $    655.30
EC2 - Other                    $    400.25
Amazon Virtual Private Cloud   $    150.10
AWS CloudTrail                 $     95.55
Amazon Elastic Load Balancing  $     72.80
Amazon Elastic Compute Cloud - Compute $     51.20
Amazon GuardDuty               $     33.70
Amazon Security Lake           $     19.85
AWS Security Hub               $     13.45
AWS Key Management Service     $     10.25
AWS Config                     $      7.90
AWS Systems Manager            $      6.15
AmazonCloudWatch               $      1.75
Amazon Simple Storage Service  $      0.60
Amazon Macie                   $      0.35
AWS Cost Explorer              $      0.30
Amazon Route 53                $      0.20
Amazon EC2 Container Registry (ECR) $      0.15
CloudWatch Events              $      0.02
AWS Shield                     $      0.01
--------------------------------------------------
TOTAL                          $  1,519.88
```
